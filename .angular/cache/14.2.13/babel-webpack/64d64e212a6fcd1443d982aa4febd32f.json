{"ast":null,"code":"import { saveAs } from 'file-saver';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/ftp.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/card\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/icon\";\n\nfunction ListComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 11)(1, \"mat-icon\", 12);\n    i0.ÉµÉµtext(2, \"cloud_off\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(3, \"p\", 13);\n    i0.ÉµÉµtext(4, \"No hay archivos disponibles.\");\n    i0.ÉµÉµelementEnd()();\n  }\n}\n\nfunction ListComponent_div_17_mat_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ÉµÉµgetCurrentView();\n\n    i0.ÉµÉµelementStart(0, \"mat-card\", 16)(1, \"mat-card-header\")(2, \"mat-icon\", 17);\n    i0.ÉµÉµtext(3, \"insert_drive_file\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(4, \"mat-card-title\");\n    i0.ÉµÉµtext(5);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(6, \"mat-card-subtitle\");\n    i0.ÉµÉµtext(7);\n    i0.ÉµÉµpipe(8, \"number\");\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(9, \"mat-card-content\")(10, \"p\")(11, \"strong\");\n    i0.ÉµÉµtext(12, \"Tipo:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(13);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(14, \"p\")(15, \"strong\");\n    i0.ÉµÉµtext(16, \"Modificado:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(17);\n    i0.ÉµÉµpipe(18, \"date\");\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(19, \"mat-card-actions\")(20, \"button\", 18);\n    i0.ÉµÉµlistener(\"click\", function ListComponent_div_17_mat_card_1_Template_button_click_20_listener() {\n      const restoredCtx = i0.ÉµÉµrestoreView(_r6);\n      const file_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ÉµÉµnextContext(2);\n      return i0.ÉµÉµresetView(ctx_r5.descargarArchivo(file_r4.name));\n    });\n    i0.ÉµÉµelementStart(21, \"mat-icon\");\n    i0.ÉµÉµtext(22, \"download\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(23, \" Descargar \");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(24, \"button\", 19);\n    i0.ÉµÉµlistener(\"click\", function ListComponent_div_17_mat_card_1_Template_button_click_24_listener() {\n      const restoredCtx = i0.ÉµÉµrestoreView(_r6);\n      const file_r4 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ÉµÉµnextContext(2);\n      return i0.ÉµÉµresetView(ctx_r7.eliminarArchivo(file_r4.name));\n    });\n    i0.ÉµÉµelementStart(25, \"mat-icon\");\n    i0.ÉµÉµtext(26, \"delete\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(27, \" Eliminar \");\n    i0.ÉµÉµelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const file_r4 = ctx.$implicit;\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµtextInterpolate(file_r4.name);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate1(\"\", i0.ÉµÉµpipeBind1(8, 4, file_r4.size), \" bytes\");\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµtextInterpolate1(\" \", file_r4.type, \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate1(\" \", i0.ÉµÉµpipeBind2(18, 6, file_r4.modifiedAt, \"short\"), \"\");\n  }\n}\n\nfunction ListComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 14);\n    i0.ÉµÉµtemplate(1, ListComponent_div_17_mat_card_1_Template, 28, 9, \"mat-card\", 15);\n    i0.ÉµÉµelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(1);\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r2.files);\n  }\n}\n\nexport let ListComponent = /*#__PURE__*/(() => {\n  class ListComponent {\n    constructor(ftpService, router) {\n      this.ftpService = ftpService;\n      this.router = router;\n      this.files = [];\n      this.userApp = {\n        username: \"string\",\n        password: \"string\"\n      };\n    }\n\n    ngOnInit() {\n      this.obternetArchivos();\n    }\n\n    obternetArchivos() {\n      const userApp = localStorage.getItem('dato1');\n      const passApp = localStorage.getItem('dato2');\n\n      if (userApp !== null && passApp !== null) {\n        this.userApp = {\n          username: userApp,\n          password: passApp\n        };\n      }\n\n      this.ftpService.listFiles(this.userApp).subscribe({\n        next: data => {\n          //console.log('Archivos recibidos del servidor:', data);  // ðŸ‘ˆ AquÃ­\n          this.files = data;\n        },\n        error: err => console.error('Error al obtener archivos:', err)\n      });\n    }\n\n    onArchivoSeleccionado(event) {\n      const input = event.target;\n\n      if (!input.files || input.files.length === 0) {\n        alert('Selecciona un archivo primero');\n        return;\n      }\n\n      const archivo = input.files[0];\n      const userApp = localStorage.getItem('dato1');\n      const passApp = localStorage.getItem('dato2');\n\n      if (userApp && passApp) {\n        const user = {\n          username: userApp,\n          password: passApp\n        };\n        this.ftpService.subirArchivo(archivo, user).subscribe({\n          next: () => {\n            alert('Archivo subido correctamente');\n            this.obternetArchivos(); // refresca lista\n          },\n          error: err => {\n            console.error('Error al subir archivo:', err);\n            alert('Error al subir el archivo');\n          }\n        });\n        input.value = ''; // limpia el input para que se pueda volver a subir el mismo\n      } else {\n        alert('Credenciales no encontradas');\n      }\n    }\n\n    descargarArchivo(nombre) {\n      const userApp = localStorage.getItem('dato1');\n      const passApp = localStorage.getItem('dato2');\n\n      if (userApp !== null && passApp !== null) {\n        this.userApp = {\n          username: userApp,\n          password: passApp\n        };\n      }\n\n      this.ftpService.descargarArchivo(nombre, this.userApp).subscribe({\n        next: blob => {\n          saveAs(blob, nombre);\n        },\n        error: err => {\n          console.error('Error al descargar archivo:', err);\n          alert('No se pudo descargar el archivo');\n        }\n      });\n    }\n\n    eliminarArchivo(nombre) {\n      if (confirm(`Â¿Seguro que quieres eliminar \"${nombre}\"?`)) {\n        const userApp = localStorage.getItem('dato1');\n        const passApp = localStorage.getItem('dato2');\n\n        if (userApp !== null && passApp !== null) {\n          this.userApp = {\n            username: userApp,\n            password: passApp\n          };\n        }\n\n        this.ftpService.eliminarArchivo(nombre, this.userApp).subscribe({\n          next: () => {\n            alert('Archivo eliminado Correctamente');\n            this.obternetArchivos(); // refresca la lista\n          },\n          error: err => {\n            console.error('Error al eliminar archivo:', err);\n            alert('Error al eliminar el archivo');\n          }\n        });\n      }\n    }\n\n    cerrarSesion() {\n      localStorage.removeItem('token');\n      localStorage.removeItem('dato1');\n      localStorage.removeItem('dato2');\n      this.router.navigate(['/login']);\n    }\n\n  }\n\n  ListComponent.Éµfac = function ListComponent_Factory(t) {\n    return new (t || ListComponent)(i0.ÉµÉµdirectiveInject(i1.FtpService), i0.ÉµÉµdirectiveInject(i2.Router));\n  };\n\n  ListComponent.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n    type: ListComponent,\n    selectors: [[\"app-archivo-lista\"]],\n    decls: 18,\n    vars: 2,\n    consts: [[1, \"header\"], [1, \"header-left\"], [\"aria-label\", \"Nombre de la plataforma\", 1, \"title\"], [1, \"header-right\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"aria-label\", \"Subir archivo\", 3, \"click\"], [\"type\", \"file\", \"hidden\", \"\", \"aria-hidden\", \"true\", 3, \"change\"], [\"fileInput\", \"\"], [\"mat-stroked-button\", \"\", \"color\", \"warn\", \"aria-label\", \"Cerrar sesi\\u00F3n\", 3, \"click\"], [\"role\", \"region\", \"aria-label\", \"Lista de archivos\", 1, \"file-container\"], [\"class\", \"empty-state\", 4, \"ngIf\"], [\"class\", \"grid\", 4, \"ngIf\"], [1, \"empty-state\"], [1, \"empty-icon\"], [1, \"empty-text\"], [1, \"grid\"], [\"class\", \"file-card\", \"tabindex\", \"0\", \"aria-disabled\", \"true\", 4, \"ngFor\", \"ngForOf\"], [\"tabindex\", \"0\", \"aria-disabled\", \"true\", 1, \"file-card\"], [\"mat-card-avatar\", \"\", \"aria-hidden\", \"true\"], [\"mat-button\", \"\", \"color\", \"primary\", \"aria-disabled\", \"true\", 3, \"click\"], [\"mat-button\", \"\", \"color\", \"warn\", \"aria-disabled\", \"true\", 3, \"click\"]],\n    template: function ListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r8 = i0.ÉµÉµgetCurrentView();\n\n        i0.ÉµÉµelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\", 2);\n        i0.ÉµÉµtext(3, \"\\uD83D\\uDCC1 JimmyCloud\");\n        i0.ÉµÉµelementEnd()();\n        i0.ÉµÉµelementStart(4, \"div\", 3)(5, \"button\", 4);\n        i0.ÉµÉµlistener(\"click\", function ListComponent_Template_button_click_5_listener() {\n          i0.ÉµÉµrestoreView(_r8);\n\n          const _r0 = i0.ÉµÉµreference(10);\n\n          return i0.ÉµÉµresetView(_r0.click());\n        });\n        i0.ÉµÉµelementStart(6, \"mat-icon\");\n        i0.ÉµÉµtext(7, \"upload\");\n        i0.ÉµÉµelementEnd();\n        i0.ÉµÉµtext(8, \" Subir \");\n        i0.ÉµÉµelementEnd();\n        i0.ÉµÉµelementStart(9, \"input\", 5, 6);\n        i0.ÉµÉµlistener(\"change\", function ListComponent_Template_input_change_9_listener($event) {\n          return ctx.onArchivoSeleccionado($event);\n        });\n        i0.ÉµÉµelementEnd();\n        i0.ÉµÉµelementStart(11, \"button\", 7);\n        i0.ÉµÉµlistener(\"click\", function ListComponent_Template_button_click_11_listener() {\n          return ctx.cerrarSesion();\n        });\n        i0.ÉµÉµelementStart(12, \"mat-icon\");\n        i0.ÉµÉµtext(13, \"logout\");\n        i0.ÉµÉµelementEnd();\n        i0.ÉµÉµtext(14, \" Salir \");\n        i0.ÉµÉµelementEnd()()();\n        i0.ÉµÉµelementStart(15, \"div\", 8);\n        i0.ÉµÉµtemplate(16, ListComponent_div_16_Template, 5, 0, \"div\", 9);\n        i0.ÉµÉµtemplate(17, ListComponent_div_17_Template, 2, 1, \"div\", 10);\n        i0.ÉµÉµelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ÉµÉµadvance(16);\n        i0.ÉµÉµproperty(\"ngIf\", ctx.files.length === 0);\n        i0.ÉµÉµadvance(1);\n        i0.ÉµÉµproperty(\"ngIf\", ctx.files.length > 0);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.MatCard, i4.MatCardHeader, i4.MatCardContent, i4.MatCardTitle, i4.MatCardSubtitle, i4.MatCardActions, i4.MatCardAvatar, i5.MatButton, i6.MatIcon, i3.DecimalPipe, i3.DatePipe],\n    styles: [\"[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:100vh;background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);padding:24px;box-sizing:border-box}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background-color:#fffd;padding:16px 24px;border-radius:12px;box-shadow:0 4px 12px #0000001a;margin-bottom:32px;.title {font-size: 1.8rem; font-weight: bold; margin: 0;} .header-right button {margin-left: 12px;}}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:80px;text-align:center;.empty-icon {font-size: 64px; color: #9e9e9e; margin-bottom: 16px;} .empty-text {font-size: 1.2rem; color: #666;}}.file-container[_ngcontent-%COMP%]{flex-grow:1}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}.file-card[_ngcontent-%COMP%]{border-radius:12px;transition:transform .2s ease,box-shadow .2s ease;&:hover{transform:translateY(-5px);box-shadow:0 8px 20px #00000026}mat-card-header {mat-card-title {font-weight: 600;} mat-card-subtitle {font-size: .85rem; color: #888;}} mat-card-content {font-size: .95rem; p {margin: 4px 0;} a {color: #3f51b5; text-decoration: none; &:hover {text-decoration: underline;}}} mat-card-actions {display: flex; justify-content: space-between;}}@media (max-width: 600px){.header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.header-right[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end;flex-wrap:wrap;button {margin-left: 8px;}}}\"]\n  });\n  return ListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}